<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Design</title>
    <meta name="description" content="Bring your Lovett's Designs & Crafts ideas to life with our tailored design studio." />
    <link rel="stylesheet" href="styles.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    
    <style>
      :root {
        color-scheme: light;
      }
      body {
        margin: 0;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        background: radial-gradient(circle at top left, rgba(224, 176, 255, 0.45), transparent 55%), radial-gradient(circle at bottom right, rgba(153, 40, 177, 0.32), transparent 60%), linear-gradient(135deg, #f5f3ff 0%, #ede9fe 40%, #faf5ff 100%);
        color: #1f0f24;
      }
      a {
        color: inherit;
      }
      .page-shell {
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
      }
      header {
        position: sticky;
        top: 0;
        z-index: 20;
        backdrop-filter: blur(16px);
        background: rgba(250, 245, 255, 0.85);
        border-bottom: 1px solid rgba(153, 40, 177, 0.12);
      }
      .header-inner {
        display: flex;
        align-items: center;
        justify-content: space-between;
        height: 64px;
      }
      .brand-mark {
        display: inline-flex;
        align-items: center;
        gap: 0.75rem;
        font-weight: 600;
        letter-spacing: 0.14em;
        text-transform: uppercase;
      }
      .brand-mark img {
        width: 40px;
        height: 40px;
        border-radius: 12px;
        object-fit: cover;
      }
      .home-link {
        display: inline-flex;
        align-items: center;
        gap: 0.4rem;
        padding: 0.55rem 1.1rem;
        border-radius: 999px;
        border: 1px solid rgba(153, 40, 177, 0.25);
        background: rgba(255, 255, 255, 0.8);
        font-size: 0.75rem;
        letter-spacing: 0.16em;
        text-transform: uppercase;
        transition: transform 160ms ease, box-shadow 160ms ease, background 160ms ease;
      }
      .home-link:hover {
        transform: translateY(-2px);
        box-shadow: 0 14px 32px rgba(153, 40, 177, 0.22);
        background: linear-gradient(135deg, #ffd166 0%, #f97316 100%);
        color: #1f0f24;
      }
      .hero {
        padding: clamp(4rem, 9vw, 6rem) 0 clamp(3rem, 7vw, 5rem);
      }
      .hero-card {
        max-width: 1040px;
        margin: 0 auto;
        border-radius: 2.75rem;
        overflow: hidden;
        box-shadow: 0 30px 70px rgba(79, 70, 229, 0.18);
        border: 1px solid rgba(153, 40, 177, 0.18);
        background: #ffffff;
      }
      .hero-top {
        padding: clamp(2.5rem, 5vw, 3.5rem) clamp(2.25rem, 6vw, 4.5rem);
        text-align: center;
        background: linear-gradient(135deg, #E0B0FF 0%, #D8B4FE 100%);
        color: #ffffff;
      }
      .hero-eyebrow {
        font-size: 0.75rem;
        letter-spacing: 0.32em;
        text-transform: uppercase;
        font-weight: 600;
        display: inline-flex;
        gap: 0.45rem;
        align-items: center;
      }
      .hero-heading {
        margin-top: 1.5rem;
        font-family: Georgia, 'Times New Roman', serif;
        font-size: clamp(2.75rem, 7vw, 4.75rem);
        text-transform: uppercase;
        letter-spacing: 0.18em;
      }
      .hero-tagline {
        margin-top: 1.25rem;
        font-size: clamp(1rem, 2.2vw, 1.25rem);
        line-height: 1.8;
        opacity: 0.92;
      }
      .hero-bottom {
        padding: clamp(2.25rem, 6vw, 3.75rem);
        background: rgba(255, 255, 255, 0.85);
      }
      .preview-frame {
        border-radius: 2.5rem;
        border: 1px solid rgba(153, 40, 177, 0.18);
        overflow: hidden;
        box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.18);
        min-height: 260px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: radial-gradient(circle at top, rgba(224, 176, 255, 0.35), rgba(255,255,255,0.9));
      }
      .preview-frame img {
        display: block;
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
      .preview-placeholder {
        font-size: 0.95rem;
        letter-spacing: 0.2em;
        text-transform: uppercase;
        color: rgba(31, 15, 36, 0.6);
      }
      .section-eyebrow {
        margin-top: clamp(2.5rem, 7vw, 3.5rem);
        font-size: 0.75rem;
        letter-spacing: 0.32em;
        text-transform: uppercase;
        font-weight: 600;
        text-align: center;
        color: rgba(31, 15, 36, 0.68);
      }
      .swatch-grid {
        margin-top: 1.75rem;
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(56px, 1fr));
        gap: 1rem;
        justify-items: center;
      }
      .swatch {
        width: 40px;
        height: 40px;
        border-radius: 999px;
        border: 3px solid #fff;
        box-shadow: 0 14px 20px rgba(81, 56, 105, 0.16);
        transition: transform 0.18s ease, box-shadow 0.18s ease, outline-color 0.18s ease;
      }
      .swatch.is-active {
        box-shadow: 0 0 0 3px rgba(168, 139, 208, 0.35), 0 8px 16px rgba(168, 139, 208, 0.28);
        border-color: #A88BD0 !important;
        outline: 2px solid #A88BD0 !important;
        outline-offset: 2px;
        transform: translateY(-1px);
        scale: 1.08;
      }
      .design-swatch-slider {
        justify-content: center;
        gap: 0.75rem;
      }
      .design-swatch-slider[data-swatch-align="center"] .design-swatch-track {
        justify-content: center;
        width: 100%;
      }
      .design-swatch-slider button[data-swatch-prev],
      .design-swatch-slider button[data-swatch-next] {
        width: 2.5rem !important;
        height: 2.5rem !important;
        border: 1px solid #e2e8f0 !important;
        background: #ffffff !important;
        border-radius: 9999px;
        box-shadow: 0 6px 14px rgba(31, 18, 52, 0.12) !important;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
        opacity: 1 !important;
        visibility: visible !important;
        transition: transform 0.2s ease, opacity 0.2s ease;
      }
      .design-swatch-slider button[data-swatch-prev]:hover,
      .design-swatch-slider button[data-swatch-next]:hover {
        transform: translateY(-2px);
      }
      .design-swatch-window {
        width: auto;
        max-width: 100%;
        overflow: hidden;
        padding: 0.55rem 0.35rem;
        box-sizing: content-box;
      }
      @media (max-width: 767px) {
        .design-swatch-window {
          padding-left: 0.25rem;
          padding-right: 0.25rem;
          box-sizing: border-box;
          width: calc((48px * 4) + (0.5rem * 3) + 0.5rem) !important;
          max-width: calc((48px * 4) + (0.5rem * 3) + 0.5rem) !important;
        }
        .design-swatch-slider .swatch.is-active {
          scale: 1;
          transform: none;
          outline-offset: 0;
        }
      }
      .design-swatch-track {
        gap: 0.5rem;
        align-items: center;
      }
      .design-swatch-slider .swatch {
        flex: 0 0 auto;
      }
      [data-design-colors-source] .swatch,
      [data-design-accessories-source] .swatch {
        width: 48px;
        height: 48px;
        border-width: 3px;
      }
      .design-swatch-slider button svg {
        color: #6b4a7a;
        stroke: currentColor;
      }
      .design-layout {
        display: grid;
        gap: 1.75rem;
        align-items: center;
      }
      @media (min-width: 768px) {
        .design-layout {
          grid-template-columns: minmax(0, 220px) minmax(0, 1fr) minmax(0, 220px);
        }
      }
      .design-palette-column {
        text-align: center;
      }
      .design-feature .palette-label {
        font-size: 0.75rem;
        letter-spacing: 0.32em;
        text-transform: uppercase;
        font-weight: 600;
        color: #000 !important;
        margin-bottom: 0.75rem;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        text-align: center;
      }
      .design-notes-panel {
        margin-top: 1.25rem;
        border-radius: 1.5rem;
        border: 1px solid rgba(153, 40, 177, 0.18);
        background: rgba(248, 245, 255, 0.9);
        padding: 0.75rem;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 0.75rem;
        width: 100%;
        max-width: 720px;
        margin-left: auto;
        margin-right: auto;
      }
      .design-notes-grid {
        display: grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        gap: 0.65rem;
        width: 100%;
        justify-items: center;
      }
      .design-notes-grid > div {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 0.75rem;
      }
      .design-notes-grid .wrap-field {
        grid-column: 1 / -1;
        align-items: center;
      }
      .design-notes-grid .wrap-field .design-selection-target--wrap {
        margin: 0 auto;
      }
      .design-notes-grid > div .design-selection-target {
        width: 100%;
      }
      .design-selection-target {
        border-radius: 1rem;
        border: 1px dashed rgba(153, 40, 177, 0.35);
        background: rgba(255, 255, 255, 0.75);
        padding: 0.6rem;
        display: grid;
        grid-template-columns: auto minmax(0, 1fr) auto;
        align-items: center;
        gap: 0.65rem;
        min-height: 56px;
        transition: border-color 150ms ease, background 150ms ease;
      }
      .design-selection-target.has-selection {
        border-style: solid;
        border-color: rgba(153, 40, 177, 0.65);
        background: #ffffff;
      }
      .design-selection-swatch {
        width: 44px;
        height: 44px;
        border-radius: 999px;
        border: 1px solid rgba(15, 23, 42, 0.08);
        background: rgba(241, 245, 249, 0.8);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.2rem;
        color: #0f172a;
      }
      .design-selection-target.has-selection .design-selection-swatch {
        border-color: transparent;
      }
      .design-selection-target--wrap {
        width: 100%;
        max-width: 520px;
      }
      .design-selection-label {
        font-size: 0.85rem;
        color: rgba(31, 15, 36, 0.75);
        letter-spacing: 0.04em;
        text-align: left;
      }
      @media (max-width: 767px) {
        .design-selection-label {
          line-height: 1.2;
          min-height: 2.4em;
          display: flex;
          align-items: center;
        }
      }
      .design-price-wrapper {
        display: flex;
        justify-content: center;
        margin-top: 1rem;
      }
      .design-price-bubble {
        border-radius: 999px;
        background: rgba(255, 255, 255, 0.95);
        border: 1px solid rgba(153, 40, 177, 0.25);
        padding: 0.35rem 0.9rem;
        display: inline-flex;
        align-items: center;
        justify-content: center;
      }
      .design-cta {
        margin-top: -0.5in;
      }
      .design-price-value {
        font-size: 1.05rem;
        font-weight: 700;
        letter-spacing: 0.05em;
        color: #15803d;
      }
      .design-wrap-row {
        display: grid;
        grid-template-columns: minmax(0, 1fr) auto;
        align-items: end;
        gap: 0.75rem;
      }
      .design-selection-clear {
        border: none;
        background: transparent;
        font-size: 1.1rem;
        color: rgba(15, 15, 36, 0.4);
        cursor: pointer;
        padding: 0.25rem 0.4rem;
        border-radius: 999px;
        transition: color 150ms ease, background 150ms ease;
        display: none;
      }
      .design-selection-target.has-selection .design-selection-clear {
        color: rgba(15, 15, 36, 0.75);
        display: inline-flex;
        align-items: center;
        justify-content: center;
      }
      .design-selection-clear:hover,
      .design-selection-clear:focus-visible {
        color: rgba(153, 40, 177, 0.85);
        background: rgba(153, 40, 177, 0.1);
      }
.design-notes {
        margin-top: 1rem;
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
        color: #000;
      }
      .design-notes-field {
        display: inline-flex;
        align-items: stretch;
        justify-content: center;
        padding: 0.35rem 0.5rem;
        width: auto;
        max-width: 100%;
        margin: 0 auto;
        border-radius: 0.85rem;
        border: 1px dashed rgba(153, 40, 177, 0.35);
        background: rgba(255, 255, 255, 0.75);
        overflow: hidden;
        box-sizing: border-box;
      }
      .design-notes-field:focus-within {
        outline: 2px solid rgba(153, 40, 177, 0.35);
        outline-offset: 2px;
      }
      .design-notes label {
        font-size: 0.75rem;
        letter-spacing: 0.18em;
        text-transform: uppercase;
        font-weight: 600;
        color: #000 !important;
      }
      .design-notes-label {
        align-self: center;
        text-align: center;
      }
      .design-notes textarea {
        display: block;
        flex: 0 1 auto;
        width: clamp(280px, 90vw, 820px);
        max-width: 100%;
        box-sizing: border-box;
        border: none;
        background: rgba(255, 255, 255, 0.9);
        padding: 1rem 1.25rem;
        min-height: 140px;
        height: auto;
        resize: none;
        overflow: hidden;
        font-size: 0.9rem;
        font-family: inherit;
        color: #000 !important;
        opacity: 1 !important;
        height: 100%;
      }
      .design-notes textarea::placeholder {
        color: #000 !important;
        opacity: 1 !important;
      }
      .design-notes textarea:focus {
        outline: none;
      }
      .design-notes-panel {
        margin-top: 1.25rem;
        border-radius: 1.5rem;
        border: 1px solid rgba(153, 40, 177, 0.18);
        background: rgba(248, 245, 255, 0.9);
        padding: 0.75rem;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 0.75rem;
        width: 100%;
        max-width: 720px;
        margin-left: auto;
        margin-right: auto;
      }
      .design-notes-grid {
        display: grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        gap: 0.65rem;
        width: 100%;
        justify-items: center;
      }
      .design-selection-target {
        border-radius: 1rem;
        border: 1px dashed rgba(153, 40, 177, 0.35);
        background: rgba(255, 255, 255, 0.75);
        padding: 0.6rem;
        display: flex;
        align-items: center;
        gap: 0.65rem;
        min-height: 56px;
        transition: border-color 150ms ease, background 150ms ease;
      }
      .design-selection-target.has-selection {
        border-style: solid;
        border-color: rgba(153, 40, 177, 0.65);
        background: #ffffff;
      }
      .design-selection-swatch {
        width: 44px;
        height: 44px;
        border-radius: 999px;
        border: 1px solid rgba(15, 23, 42, 0.08);
        background: rgba(241, 245, 249, 0.8);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.2rem;
        color: #0f172a;
      }
      .design-selection-target.has-selection .design-selection-swatch {
        border-color: transparent;
      }
      .design-selection-label {
        font-size: 0.85rem;
        color: rgba(31, 15, 36, 0.75);
        letter-spacing: 0.04em;
        text-align: left;
      }
      .align-bottom {
        margin-top: 0;
      }
      .design-video-frame {
        width: 100%;
        min-height: 240px;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        overflow: hidden;
      }
      .design-video-frame video {
        width: 100%;
        height: 100%;
        border-radius: inherit;
        object-fit: contain;
        background: #000;
        transition: opacity 150ms ease, visibility 150ms ease;
      }
      .design-video-message {
        position: absolute;
        inset: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 1.5rem;
        text-align: center;
        background: rgba(248, 245, 255, 0.98);
        color: #1f0f24 !important;
      }
      .design-video-message-inner {
        display: flex;
        flex-direction: column;
        gap: 0.65rem;
        max-width: 320px;
      }
      .design-video-message-title {
        font-size: 1.15rem;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        font-weight: 600;
        color: #1f0f24 !important;
      }
      .design-video-message-body {
        font-size: 0.95rem;
        line-height: 1.5;
        color: rgba(31, 15, 36, 0.8) !important;
      }
      .design-video-message-cta {
        display: inline-flex;
        justify-content: center;
        align-items: center;
        padding: 0.6rem 1.4rem;
        border-radius: 999px;
        background: linear-gradient(135deg, #E0B0FF 0%, #D8B4FE 100%);
        color: #1f0f24 !important;
        font-weight: 600;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        font-size: 0.75rem;
        text-decoration: none !important;
      }
      .design-video-message[hidden] {
        display: none;
      }
      .support-upload {
        display: grid;
        gap: 0.4rem;
        margin-top: 0.5rem;
      }
      .support-upload-trigger {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
        width: 100%;
        border-radius: 0.9rem;
        padding: 0.85rem 1rem;
        border: 1px dashed rgba(153, 40, 177, 0.45);
        background: rgba(248, 245, 255, 0.75);
        color: #1f0f24;
        font-weight: 700;
        letter-spacing: 0.1em;
        text-transform: uppercase;
        cursor: pointer;
        transition: transform 150ms ease, box-shadow 150ms ease, border-color 150ms ease;
      }
      .support-upload-trigger:hover {
        transform: translateY(-1px);
        box-shadow: 0 10px 22px rgba(17, 24, 39, 0.18);
        border-color: rgba(153, 40, 177, 0.7);
      }
      .support-upload-help {
        margin: 0;
        font-size: 0.85rem;
        opacity: 0.85;
        text-align: center;
        color: #1f0f24;
      }
      .support-upload-input {
        display: none;
      }
      .design-media-grid {
        margin-top: 1.5rem;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 1rem;
      }
      .design-media-grid .wrap-menu {
        margin: 0;
      }
      .design-palette {
        display: grid;
        grid-template-columns: repeat(5, minmax(0, 1fr));
        gap: 0.65rem;
        justify-items: center;
      }
      .design-palette .swatch {
        width: 40px;
        height: 40px;
        border-width: 3px;
      }
      .design-palette-title--bar {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
        padding: 0.9rem 1rem;
        border-radius: 1rem;
        background: rgba(248, 245, 255, 0.9);
        border: 1px solid rgba(153, 40, 177, 0.2);
        font-size: 0.75rem;
        letter-spacing: 0.18em;
        text-transform: uppercase;
        font-weight: 600;
        color: #000 !important;
        width: 100%;
        max-width: 720px;
        margin: 0 auto 0.5rem;
      }
      .design-card {
        border-radius: 1.75rem;
        border: 1px solid rgba(153, 40, 177, 0.15);
        background: #ffffff;
        box-shadow: 0 25px 45px rgba(112, 26, 117, 0.12);
        max-width: 20rem;
        margin: 0 auto;
        width: 100%;
        overflow: hidden;
      }
      .design-card-header {
        padding: 1.25rem 1.5rem;
        text-align: center;
        background: linear-gradient(135deg, #E0B0FF 0%, #D8B4FE 100%);
        color: #fff;
      }
      .design-card-header * {
        color: #fff !important;
      }
      .design-card-header h2 {
        margin: 0.25rem 0 0;
        font-size: 1.8rem;
        letter-spacing: 0.18em;
        text-transform: uppercase;
        color: #fff;
      }
      .design-card-header .design-heading-link {
        color: inherit;
        text-decoration: none;
        transition: transform 180ms ease, color 180ms ease;
        display: inline-block;
      }
      .design-card-header .design-heading-link:hover {
        transform: scale(1.04);
        color: #fff;
      }
      .design-card--full {
        max-width: min(1100px, 100%);
        margin: 0 auto;
      }
      .design-card-body {
        padding: 1.25rem;
        background: #ffffff;
      }
      .design-palette-grid {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 1.5rem;
      }
      .design-center {
        display: flex;
        flex-direction: column;
        gap: 1rem;
        align-items: center;
        width: 100%;
      }
      .wrap-menu {
        margin-top: 1.25rem;
        border: 1px solid rgba(153, 40, 177, 0.2);
        border-radius: 1rem;
        overflow: hidden;
        background: rgba(248, 245, 255, 0.8);
        width: 100%;
        max-width: 720px;
        margin-left: auto;
        margin-right: auto;
      }
      .wrap-menu summary {
        list-style: none;
        cursor: pointer;
        padding: 0.9rem 1rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.18em;
        font-size: 0.75rem;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
        color: #000 !important;
        background: rgba(248, 245, 255, 0.95);
      }
      .wrap-menu[open] summary {
        background: rgba(153, 40, 177, 0.08);
      }
      .wrap-menu summary::-webkit-details-marker {
        display: none;
      }
      .wrap-menu summary svg {
        width: 1rem;
        height: 1rem;
        transition: transform 200ms ease;
        color: #000 !important;
        stroke: currentColor;
      }
      .wrap-menu[open] summary svg {
        transform: rotate(180deg);
      }
      .wrap-menu ul {
        margin: 0;
        padding: 0.25rem 0 0.75rem;
        list-style: none;
        display: grid;
        gap: 0.35rem;
      }
      .wrap-menu li {
        padding: 0.4rem 1rem;
        font-size: 0.85rem;
        color: #3f2a56;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .wrap-menu li span {
        font-weight: 600;
      }
      .palette-menu {
        width: 100%;
        margin-top: 0;
      }
      .palette-menu summary {
        display: flex;
        color: #000 !important;
        opacity: 1 !important;
      }
      .palette-menu summary span {
        color: #000 !important;
        opacity: 1 !important;
      }
      .palette-menu summary::-webkit-details-marker {
        display: none;
      }
      .palette-content {
        display: block;
        padding: 0;
        background: rgba(248, 245, 255, 0.9);
      }
      @media (max-width: 767px) {
        .palette-content {
          display: none;
          padding: 0 1rem 1rem;
        }
        .palette-menu[open] .palette-content {
          display: block;
        }
        .palette-label--desktop {
          display: none;
        }
      }
      @media (min-width: 768px) {
        .palette-content {
          display: block !important;
          padding: 0;
          background: transparent;
        }
      }
      .design-card-frame {
        border-radius: 1.5rem;
        aspect-ratio: 9 / 16;
        display: flex;
        align-items: stretch;
        justify-content: center;
        border: 1px solid rgba(153, 40, 177, 0.18);
        background: rgba(248, 245, 255, 0.85);
        padding: 0.95rem;
        min-height: clamp(260px, 38vw, 360px);
        max-width: 380px;
      }
      .design-preview-row {
        width: 100%;
        display: grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        grid-template-areas:
          "preview preview"
          "color accessory";
        align-items: center;
        justify-items: center;
        gap: 1.25rem;
      }
      .design-preview-row .design-preview-frame {
        grid-area: preview;
      }
      .design-preview-row .design-preview-tile--color {
        grid-area: color;
      }
      .design-preview-row .design-preview-tile--accessory {
        grid-area: accessory;
      }
      @media (min-width: 900px) {
        .design-preview-row {
          display: flex;
          flex-direction: row;
          align-items: center;
          justify-content: center;
        }
      }
      .design-preview-tile {
        width: min(40vw, 180px);
        height: min(40vw, 180px);
        border-radius: 1.5rem;
        border: 1px solid rgba(153, 40, 177, 0.18);
        background: rgba(248, 245, 255, 0.85);
        box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.2);
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
        position: relative;
      }
      .design-preview-fill {
        width: 100%;
        height: 100%;
        border-radius: inherit;
        display: flex;
        align-items: center;
        justify-content: center;
        background: radial-gradient(circle at 35% 35%, rgba(238, 242, 255, 0.9) 0%, rgba(148, 163, 184, 0.35) 100%);
        transition: transform 160ms ease;
        position: relative;
      }
      .design-preview-tile.has-selection .design-preview-fill {
        transform: scale(1.01);
      }
      .design-preview-placeholder {
        font-size: 0.75rem;
        letter-spacing: 0.18em;
        text-transform: uppercase;
        color: #6b4a78;
        text-align: center;
        padding: 0 1rem;
        line-height: 1.4;
      }
      @media (max-width: 899px) {
        .design-preview-tile--color .design-preview-placeholder {
          display: inline-block;
          max-width: 7rem;
        }
      }
      .design-preview-tile.has-selection .design-preview-placeholder {
        opacity: 0;
      }
      .design-preview-glyph {
        position: absolute;
        font-size: 1.8rem;
        line-height: 1;
      }
      .design-preview-tile:not(.has-selection) .design-preview-glyph {
        opacity: 0;
      }
      .design-preview-frame {
        position: relative;
      }
      .design-preview-clear {
        position: absolute;
        top: 0.65rem;
        right: 0.65rem;
        z-index: 3;
        border: none;
        width: 1.8rem;
        height: 1.8rem;
        border-radius: 999px;
        background: rgba(255, 255, 255, 0.92);
        color: #6B4A78;
        font-size: 1.1rem;
        line-height: 1;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        box-shadow: 0 10px 20px rgba(15, 23, 42, 0.18);
        opacity: 0;
        pointer-events: none;
        transition: opacity 150ms ease, transform 150ms ease, background 150ms ease;
      }
      .design-preview-clear:hover,
      .design-preview-clear:focus-visible {
        transform: translateY(-1px);
        background: #ffffff;
        color: #b05cf7;
      }
      .design-preview-tile.has-selection .design-preview-clear,
      .design-preview-frame.has-image .design-preview-clear {
        opacity: 1;
        pointer-events: auto;
      }
      .design-preview-layer {
        width: 100%;
        height: 100%;
      }
      .design-preview-image {
        display: block;
        position: relative;
      }
      .design-preview-image img {
        display: none;
      }
      .design-preview-image.has-image img {
        display: block;
      }
      .design-preview-empty {
        pointer-events: none;
      }
      .design-preview-empty p {
        margin: 0;
      }
      .design-preview-frame .design-video-message-title,
      .design-preview-frame .design-video-message-body {
        color: #6B4A78 !important;
      }
      .design-preview-icon-inline {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        margin: 0 0.2rem;
        width: 2.25rem;
        height: 2.25rem;
        border-radius: 9999px;
        background: linear-gradient(135deg, #E0B0FF 0%, #B678F5 100%);
        color: #ffffff;
        box-shadow: 0 10px 20px rgba(153, 40, 177, 0.2);
      }
      .design-preview-icon-inline svg {
        width: 1rem;
        height: 1rem;
        color: inherit;
        fill: currentColor;
      }
      .design-preview-image.has-image .design-preview-empty {
        display: none;
      }
      .design-preview-video {
        display: none;
      }
      .design-preview-frame.is-video-active .design-preview-image {
        display: none;
      }
      .design-preview-frame.is-video-active .design-preview-video {
        display: block;
      }
      .design-preview-frame.is-prompt-active .design-preview-video {
        display: flex;
        align-items: center;
        justify-content: center;
        background: radial-gradient(circle at 20% 20%, rgba(224, 176, 255, 0.2), rgba(12, 7, 21, 0.9));
      }
      .design-preview-frame.is-prompt-active .design-preview-video video {
        display: none;
      }
      .design-preview-frame.is-prompt-active .design-video-message {
        display: flex !important;
      }
      .design-preview-return {
        position: absolute;
        top: 0.65rem;
        left: 0.65rem;
        z-index: 2;
        border: none;
        background: rgba(255, 255, 255, 0.9);
        color: #6B4A78 !important;
        padding: 0.35rem 0.75rem;
        border-radius: 999px;
        font-size: 0.75rem;
        letter-spacing: 0.12em;
        text-transform: uppercase;
        font-weight: 700;
        box-shadow: 0 10px 20px rgba(15, 23, 42, 0.2);
        cursor: pointer;
        opacity: 0;
        pointer-events: none;
        transition: opacity 150ms ease, transform 150ms ease;
      }
      .design-preview-frame.is-video-active .design-preview-return {
        opacity: 1;
        pointer-events: auto;
      }
      .design-preview-return:hover,
      .design-preview-return:focus-visible {
        transform: translateY(-1px);
      }
      .design-card-frame.design-video-frame {
        padding: 0;
        background: #0c0715;
        aspect-ratio: 9 / 16;
        min-height: clamp(360px, 55vw, 520px);
      }
      .design-card-frame img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
      .customization-flow {
        margin-top: clamp(3rem, 8vw, 4.5rem);
        margin-bottom: clamp(2.5rem, 7vw, 4rem);
        border-radius: 2.5rem;
        border: 1px solid rgba(153, 40, 177, 0.14);
        background: rgba(255, 255, 255, 0.82);
        box-shadow: 0 28px 60px rgba(79, 70, 229, 0.15);
        padding: clamp(2rem, 5vw, 3rem);
      }
      .flow-title {
        font-size: clamp(1.8rem, 4vw, 2.5rem);
        font-weight: 700;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        text-align: center;
      }
      .flow-steps {
        margin-top: 2.25rem;
        display: grid;
        gap: 1.75rem;
      }
      .flow-step {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 1.5rem;
        border-radius: 1.5rem;
        padding: 1.6rem;
        background: rgba(224, 176, 255, 0.14);
        border: 1px solid rgba(153, 40, 177, 0.12);
      }
      .flow-step h3 {
        margin: 0;
        font-size: 1.2rem;
        letter-spacing: 0.06em;
        text-transform: uppercase;
      }
      .flow-skip-note {
        display: block;
        text-align: center;
        margin-top: 0.5rem;
        font-weight: 600;
        letter-spacing: 0.02em;
      }
      .cta-wrap {
        margin-top: 0.75rem;
        text-align: center;
      }
      .cta-btn {
        display: inline-flex;
        align-items: center;
        gap: 0.55rem;
        padding: 0.95rem 1.85rem;
        border-radius: 999px;
        text-transform: uppercase;
        letter-spacing: 0.2em;
        font-size: 0.8rem;
        font-weight: 600;
        border: none;
        background: linear-gradient(135deg, #ffd166 0%, #f97316 100%);
        color: #1f0f24;
        text-decoration: none;
        transition: transform 160ms ease, box-shadow 160ms ease;
      }
      .cta-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 18px 36px rgba(249, 115, 22, 0.25);
      }
      footer {
        margin-top: auto;
        padding: 2rem 0;
        text-align: center;
        font-size: 0.75rem;
        letter-spacing: 0.12em;
        text-transform: uppercase;
        color: rgba(31, 15, 36, 0.6);
      }
    </style>
  </head>
  <body data-cloudflare-account="https://customer-3ptq6xbmg2sfpv29.cloudflarestream.com" data-medusa-enabled="true" data-medusa-backend="https://api.lovettsldc.com" data-medusa-publishable-key="pk_427f7900e23e30a0e18feaf0604aa9caaa9d0cb21571889081d2cb93fb13ffb0">
    <div class="page-shell">
      <header>
        <div class="container header-inner">
          <a href="index.html" class="brand-mark">
            <img src="assets/LDC%20LOGOS%20Black.png" alt="LDC logo" />
            <span>Lovett's Designs & Crafts</span>
          </a>
          <a href="index.html#top" class="home-link">
            <span aria-hidden="true">←</span>
            Back Home
          </a>
        </div>
      </header>

      <main>
        <section class="hero">
          <div class="hero-card">
            <div class="hero-top">
              <span class="hero-eyebrow">Design Studio</span>
              <h1 class="hero-heading">Design</h1>
              <p class="hero-tagline">
                Turn your vision into a one-of-a-kind Lovett’s creation. Select colors, finishes, engravings, and accessories to match your style or celebrate every special moment.
              </p>
            </div>
            <div class="customization-flow">
              <h2 class="flow-title">How Your Design Comes To Life</h2>
              <div class="flow-steps">
                <div class="flow-step">
                  <h3>1. Choose Your Base</h3>
                  <p>Select a tumbler, cup, bottle, or accessory silhouette and pick the exact finish and capacity you need.</p>
                </div>
                <div class="flow-step">
                  <h3>2. Personalize Every Detail</h3>
                  <p>
                    Layer on colors, lids, handles, and hardware accents. Add names, monograms, pick your design.
                    <span class="flow-skip-note">(Skip to step 4 if you are not ordering a sublimatable cup)</span>
                  </p>
                </div>
                <div class="flow-step">
                  <h3>3. Preview & Approve</h3>
                  <p>
                    Review a mock-up and request tweaks until it matches your vision perfectly.
                    <span class="flow-skip-note">(Sublimation cups only)</span>
                  </p>
                </div>
                <div class="flow-step">
                  <h3>4. Crafted & Delivered</h3>
                  <p>Your LDC creation is produced with care, inspected by hand, and prepared for pickup or shipping.</p>
                </div>
              </div>
            </div>
          </div>
        </section>

        <section class="design-feature">
          <div class="container">
            <div class="design-card design-card--full">
              <div class="design-card-header">
                <p class="text-xs font-semibold uppercase tracking-[0.35em]" style="color:#ffffff;opacity:1;">Design Studio</p>
                <h2>
                  <a href="customization.html" class="design-heading-link" aria-label="Visit the design customization page">Design</a>
                </h2>
                <p class="mt-2 text-sm" style="color:#ffffff;opacity:1;">Bring your Lovett's concepts to life.</p>
              </div>
              <div class="design-card-body">
                <div class="design-palette-grid">
                  <div class="design-center">
                    <div class="design-preview-row">
                      <div class="design-preview-tile design-preview-tile--color" aria-live="polite">
                        <button type="button" class="design-preview-clear" data-clear-preview-color aria-label="Clear color preview">&times;</button>
                        <div class="design-preview-fill" data-color-preview>
                          <span class="design-preview-placeholder">Color preview</span>
                          <span class="design-preview-glyph" aria-hidden="true"></span>
                        </div>
                      </div>
                      <div class="design-card-frame design-video-frame design-preview-frame" data-design-frame>
                        <button type="button" class="design-preview-return" data-design-back aria-label="Return to image" hidden>Return</button>
                        <button type="button" class="design-preview-clear" data-clear-preview-image aria-label="Clear image preview">&times;</button>
                        <div class="design-preview-layer design-preview-image" data-design-image-wrap>
                          <div class="design-video-message design-preview-empty" data-design-placeholder>
                            <div class="design-video-message-inner">
                              <p class="design-video-message-title">Start Your Design</p>
                              <p class="design-video-message-body">
                                Click the
                                <span class="design-preview-icon-inline icon-button tile-action-design" aria-hidden="true">
                                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                                    <path fill-rule="evenodd" d="M16.862 2.487a2.25 2.25 0 0 1 3.182 0l1.11 1.11a3.75 3.75 0 0 1 0 5.303l-8.92 8.92a4.5 4.5 0 0 1-2.038 1.159l-3.026.757a.75.75 0 0 1-.908-.908l.757-3.026a4.5 4.5 0 0 1 1.159-2.038l8.92-8.92a2.25 2.25 0 0 0 0-3.182l-1.11-1.11a.75.75 0 0 1 1.06-1.06Z" clip-rule="evenodd" />
                                    <path d="M4.5 17.25c.414 0 .75.336.75.75a1.5 1.5 0 0 1-1.5 1.5H3a.75.75 0 0 1 0-1.5h1.5a.75.75 0 0 0 .75-.75Z" />
                                  </svg>
                                </span>
                                icon on your item to begin designing!
                              </p>
                            </div>
                          </div>
                          <img id="designPagePreview" data-design-image alt="Custom design preview" />
                        </div>
                        <div class="design-preview-layer design-preview-video" aria-live="polite">
                          <div class="design-video-message" data-design-video-prompt hidden aria-hidden="true">
                            <div class="design-video-message-inner">
                              <p class="design-video-message-title" data-prompt-title>Need a Special Character or Designer Wrap?</p>
                              <p class="design-video-message-body" data-prompt-body>Share your character or designer theme with us and we will send next steps.</p>
                              <a class="design-video-message-cta" data-prompt-cta href="mailto:lovettsdandc@gmail.com">Request Custom Wrap</a>
                            </div>
                          </div>
                          <video id="designWrapVideo" data-design-video controls muted playsinline>
                            <source data-source="hls" src="" type="application/x-mpegURL" />
                          </video>
                        </div>
                      </div>
                      <div class="design-preview-tile design-preview-tile--accessory" aria-live="polite">
                        <button type="button" class="design-preview-clear" data-clear-preview-accessory aria-label="Clear accessory preview">&times;</button>
                        <div class="design-preview-fill" data-accessory-preview>
                          <span class="design-preview-placeholder">Accessory preview</span>
                          <span class="design-preview-glyph" aria-hidden="true"></span>
                        </div>
                      </div>
                    </div>
                    <div class="w-full flex justify-center">
                      <p class="design-palette-title design-palette-title--center design-palette-title--bar">Colors</p>
                    </div>
                    <div class="design-swatch-slider swatch-slider flex items-center gap-2" data-swatch-slider data-visible="7" data-visible-mobile="4">
                      <button type="button" class="w-8 h-8 inline-flex items-center justify-center" style="background:transparent;border:none;box-shadow:none;padding:0;color:inherit;" data-swatch-prev aria-label="Previous color">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m15 19-7-7 7-7"/></svg>
                      </button>
                      <div class="relative overflow-hidden design-swatch-window" data-swatch-window>
                        <div class="flex items-center design-swatch-track transition-transform duration-200" data-swatch-track data-design-colors-source>
                            <span class="swatch" aria-label="View white option" style="background: radial-gradient(circle, #ffffff 0%, #f7f7f7 55%, #d9d9d9 100%);"></span>
                            <span class="swatch" aria-label="View glow in the dark option" style="background: radial-gradient(circle, #ccff88 0%, #8dff3a 65%, #48ff5b 100%);"></span>
                            <span class="swatch" aria-label="Glass finish swatch" style="background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0) 60%), linear-gradient(135deg, rgba(226,232,240,0.7) 0%, rgba(148,163,184,0.4) 100%);"></span>
                            <!-- Removed white swatch that blended with background -->
                            <span class="swatch" aria-label="Black swatch" style="background: #1f2937;"></span>
                            <span class="swatch" aria-label="Hot pink swatch" style="background: radial-gradient(circle at 30% 30%, #ffd1e8 0%, #ff4ba5 45%, #d9048e 100%);"></span>
                            <span class="swatch" aria-label="Two-tone pink swatch" style="background: linear-gradient(135deg, #ff6fb7 0%, #ffa8df 50%, #ffd1f1 100%);"></span>
                            <span class="swatch" aria-label="Pumpkin orange swatch" style="background: radial-gradient(circle at 30% 30%, #ffd7a3 0%, #ff8b0f 50%, #b45309 100%);"></span>
                            <span class="swatch" aria-label="Light orange swatch" style="background: radial-gradient(circle, #ffe9c7 0%, #ffc17a 55%, #ffad55 100%);"></span>
                            <span class="swatch" aria-label="Orange swatch" style="background: radial-gradient(circle, #ffbb66 0%, #ff931e 60%, #ff7b00 100%);"></span>
                            <span class="swatch" aria-label="Blue swatch" style="background: radial-gradient(circle, #d8ecff 0%, #8fc7ff 55%, #4da3ff 100%);"></span>
                            <span class="swatch" aria-label="Green swatch" style="background: radial-gradient(circle, #e3fcec 0%, #6ee7b7 55%, #22c55e 100%);"></span>
                            <span class="swatch" aria-label="Pink swatch" style="background: radial-gradient(circle, #ffd6e8 0%, #f9a8d4 55%, #ec4899 100%);"></span>
                            <span class="swatch" aria-label="Red swatch" style="background: radial-gradient(circle, #ffd1d1 0%, #f87171 55%, #dc2626 100%);"></span>
                            <span class="swatch" aria-label="Glass swatch" style="background: radial-gradient(circle at 35% 35%, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0) 60%), linear-gradient(135deg, rgba(238,242,255,0.65) 0%, rgba(148,163,184,0.35) 100%);"></span>
                            <span class="swatch" aria-label="Chocolate brown swatch" style="background: radial-gradient(circle at 30% 30%, #fbd5a8 0%, #8b4513 55%, #4a2505 100%);"></span>
                            <span class="swatch" aria-label="Blue swatch" style="background: #2563eb;"></span>
                            <span class="swatch" aria-label="Purple swatch" style="background: #8b5cf6;"></span>
                            <span class="swatch" aria-label="Teal swatch" style="background: #0d9488;"></span>
                            <span class="swatch" aria-label="Pink swatch" style="background: #ec4899;"></span>
                            <span class="swatch" aria-label="White swatch" style="background: #ffffff;"></span>
                            <span class="swatch" aria-label="Hot pink swatch" style="background: #db2777;"></span>
                            <span class="swatch" aria-label="Black swatch" style="background: #000000;"></span>
                            <span class="swatch" aria-label="Navy blue swatch" style="background: #1e3a8a;"></span>
                            <span class="swatch" aria-label="Red swatch" style="background: #ef4444;"></span>
                            <span class="swatch" aria-label="Orange swatch" style="background: #f97316;"></span>
                            <span class="swatch" aria-label="Yellow swatch" style="background: #facc15;"></span>
                            <span class="swatch" aria-label="Pink swatch" style="background: #ff78c4;"></span>
                            <span class="swatch" aria-label="Hot pink swatch" style="background: #ff1493;"></span>
                            <span class="swatch" aria-label="Red swatch" style="background: #ff4d4f;"></span>
                            <span class="swatch" aria-label="Light blue swatch" style="background: #add8e6;"></span>
                            <span class="swatch" aria-label="Purple swatch" style="background: #a855f7;"></span>
                            <span class="swatch" aria-label="Orange swatch" style="background: #fb923c;"></span>
                            <span class="swatch" aria-label="Pink swatch" style="background: #ff6ec7;"></span>
                            <span class="swatch" aria-label="Glass swatch" style="background: radial-gradient(circle at 35% 35%, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0) 60%), linear-gradient(135deg, rgba(238,242,255,0.65) 0%, rgba(148,163,184,0.35) 100%);"></span>
                            <span class="swatch" aria-label="Coffee color swatch" style="background: radial-gradient(circle at 35% 35%, #f3e2c5 0%, #c58d5a 55%, #8b5a2b 100%); box-shadow: 0 0 8px rgba(139,90,43,0.4); border-color: rgba(139,90,43,0.35);"></span>
                            <span class="swatch" aria-label="White cream swatch" style="background: radial-gradient(circle, #fff9f0 0%, #f5e6d2 55%, #e7caa1 100%); box-shadow: 0 0 6px rgba(231,202,161,0.5); border-color: rgba(231,202,161,0.45);"></span>
                            <span class="swatch" aria-label="Light pink swatch" style="background: radial-gradient(circle, #ffe6f2 0%, #fbcfe8 55%, #f472b6 100%); box-shadow: 0 0 6px rgba(244,114,182,0.45); border-color: rgba(244,114,182,0.35);"></span>
                            <span class="swatch" aria-label="Light teal swatch" style="background: radial-gradient(circle, #e0fffb 0%, #a5f3fc 55%, #38bdf8 100%); box-shadow: 0 0 6px rgba(56,189,248,0.45); border-color: rgba(56,189,248,0.35);"></span>
                            <span class="swatch" aria-label="Lavender swatch" style="background: radial-gradient(circle, #f3e8ff 0%, #d8b4fe 55%, #a855f7 100%); box-shadow: 0 0 6px rgba(168,85,247,0.45); border-color: rgba(168,85,247,0.35);"></span>
                            <span class="swatch" aria-label="Lime green swatch" style="background: radial-gradient(circle, #e4fbd2 0%, #c7f26b 55%, #7ecb21 100%); box-shadow: 0 0 6px rgba(126,203,33,0.45); border-color: rgba(126,203,33,0.35);"></span>
                            <span class="swatch" aria-label="Green swatch" style="background: #22c55e;"></span>
                            <span class="swatch" aria-label="Forest green swatch" style="background: #14532d;"></span>
                            <span class="swatch" aria-label="Clear swatch" style="background: radial-gradient(circle at 35% 35%, rgba(255,255,255,0.95) 0%, rgba(148,163,184,0.3) 65%);"></span>
                            <span class="swatch" aria-label="Light pink swatch" style="background: #f9a8d4;"></span>
                            <span class="swatch" aria-label="Royal blue swatch" style="background: #1d4ed8;"></span>
                            <span class="swatch" aria-label="Black swatch" style="background: #111827;"></span>
                        </div>
                      </div>
                      <button type="button" class="w-8 h-8 inline-flex items-center justify-center" style="background:transparent;border:none;box-shadow:none;padding:0;color:inherit;" data-swatch-next aria-label="Next color">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m9 5 7 7-7 7"/></svg>
                      </button>
                    </div>
                    <div class="w-full flex justify-center">
                      <p class="design-palette-title design-palette-title--center design-palette-title--bar">Accessories</p>
                    </div>
                    <div class="design-swatch-slider swatch-slider flex items-center gap-2 mt-2" data-swatch-slider data-visible="7" data-visible-mobile="4">
                      <button type="button" class="w-8 h-8 inline-flex items-center justify-center" style="background:transparent;border:none;box-shadow:none;padding:0;color:inherit;" data-swatch-prev aria-label="Previous accessory">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m15 19-7-7 7-7"/></svg>
                      </button>
                      <div class="relative overflow-hidden design-swatch-window" data-swatch-window>
                        <div class="flex items-center design-swatch-track transition-transform duration-200" data-swatch-track data-design-accessories-source>
                            <span class="swatch" style="background:#e0f2fe; display:flex; align-items:center; justify-content:center; color:#1f2937; font-size:0.6rem; line-height:1;" aria-label="Rhinestone accessory accent" data-price="5" data-image-src="assets/rhinestone-lids-5.png" data-image-alt="Rhinestone lids">💎</span>
                            <span class="swatch" style="background:#5eead4; display:flex; align-items:center; justify-content:center; color:#0f172a; font-size:0.7rem; line-height:1;" aria-label="Jelly accessory accent" data-price="3" data-image-src="assets/Jelly Lids - 33.png" data-image-alt="Jelly lids">🪼</span>
                            <span class="swatch" style="background: radial-gradient(circle at 35% 35%, rgba(224,242,255,0.95) 0%, rgba(96,165,250,0.35) 65%); box-shadow: inset 0 0 0 1px rgba(148,163,184,0.4); display:flex; align-items:center; justify-content:center; color:#1f2937; font-size:0.7rem; line-height:1;" aria-label="Glass bow straws" data-price="3" data-image-src="assets/Glass-Bow-Straws.png" data-image-alt="Glass bow straws">🔍</span>
                            <span class="swatch" style="background:#a7f3d0; display:flex; align-items:center; justify-content:center; color:#ffffff; font-size:0.7rem; line-height:1;" aria-label="Bow accent" data-price="3" data-image-src="assets/Glass-Bow-Straws.png" data-image-alt="Bow straws">🎀</span>
                            <span class="swatch" style="background:#dbeafe; display:flex; align-items:center; justify-content:center; color:#1d4ed8; font-size:0.7rem; line-height:1;" aria-label="Swirl accent" data-price="3" data-image-src="assets/Glass Twist Straws - 3.png" data-image-alt="Twist straws">🌀</span>
                            <span class="swatch" style="background:#fda4af; display:flex; align-items:center; justify-content:center; color:#7e3030; font-size:0.7rem; line-height:1;" aria-label="Cafe accent" data-price="1" data-image-src="assets/Straw Toppers - cafe - 1.jpeg" data-image-alt="Cafe straw toppers">☕</span>
                            <span class="swatch" style="background:#f9a8d4; display:flex; align-items:center; justify-content:center; color:#7f1d1d; font-size:0.7rem; line-height:1;" aria-label="Christmas accent" data-price="1" data-image-src="assets/Straw Toppers - Christmas - 1.jpeg" data-image-alt="Christmas straw toppers">⛄️</span>
                            <span class="swatch" style="background:#fda4af; display:flex; align-items:center; justify-content:center; color:#7e3030; font-size:0.7rem; line-height:1;" aria-label="Cat accent" data-price="1" data-image-src="assets/Straw Topper - Cats - 1.jpeg" data-image-alt="Cat straw toppers">🐱</span>
                            <span class="swatch" style="background:#86efac; display:flex; align-items:center; justify-content:center; color:#14532d; font-size:0.7rem; line-height:1;" aria-label="Cactus accent" data-price="1" data-image-src="assets/Straw Toppers - Cactus - 1.png" data-image-alt="Cactus straw toppers">🌵</span>
                            <span class="swatch" style="background:#93c5fd; display:flex; align-items:center; justify-content:center; color:#1d4ed8; font-size:0.7rem; line-height:1;" aria-label="Beach cup accent" data-price="1" data-image-src="assets/straw toppers - beach cup -1.png" data-image-alt="Beach cup straw toppers">🥤</span>
                            <span class="swatch" style="background:#fef3c7; display:flex; align-items:center; justify-content:center; color:#92400e; font-size:0.7rem; line-height:1;" aria-label="Football accent" data-price="1" data-image-src="assets/straw toppers - sports - 1.png" data-image-alt="Sports straw toppers">🏈</span>
                            <span class="swatch" style="background: radial-gradient(circle at 40% 40%, #fdf6e3 0%, #f3d9a6 55%, #d3a464 100%); box-shadow: inset 0 0 0 1px rgba(128,82,29,0.25); display:flex; align-items:center; justify-content:center; color:#2f2414; font-size:0.8rem; line-height:1;" aria-label="Cowboy hat accessory" data-price="3" data-image-src="assets/Cowboy Glass Straws - 3.jpg" data-image-alt="Cowboy hat straw">🤠</span>
                        </div>
                      </div>
                      <button type="button" class="w-8 h-8 inline-flex items-center justify-center" style="background:transparent;border:none;box-shadow:none;padding:0;color:inherit;" data-swatch-next aria-label="Next accessory">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m9 5 7 7-7 7"/></svg>
                      </button>
                    </div>
                    <div class="wrap-menu" style="margin-top:0.75rem;">
                      <details>
                        <summary style="color:#000;">
                          Explore wrap templates
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" d="m6 9 6 6 6-6"/></svg>
                        </summary>
                        <ul>
                          <li data-wrap-option="seasonal-holiday" data-wrap-default="true" data-video-id="de65351aa0c825fa0c3d3a71ea6db687"><span>Seasonal / Holiday</span><small>cups &middot; mugs &middot; tumblers</small></li>
                          <li data-wrap-option="women" data-video-id="281dfbc0a9072b1ee25b87ccc9d016b6"><span>Women</span><small>cups &middot; mugs &middot; tumblers</small></li>
                          <li
                            data-wrap-option="special-designers"
                            data-video-prompt-title="Need a Special Character or Designer Wrap?"
                            data-video-prompt="Share your character or designer theme with us and we will send next steps."
                            data-video-prompt-cta-label="Request Custom Wrap"
                            data-video-prompt-cta-href="mailto:lovettsdandc@gmail.com"
                          >
                            <span>Special Characters &amp; Designers</span><small>email for custom details</small>
                          </li>
                          <li><span>Drinks</span><small>cups &middot; mugs &middot; tumblers</small></li>
                          <li data-wrap-option="boys-girls" data-video-id="4e6abab155e7cf1cd2810b095e8ac5db"><span>Boys &amp; Girls</span><small>cups &middot; mugs &middot; tumblers</small></li>
                          <li data-wrap-option="supporting-causes" data-video-id="d9c0f246f9b66240d23e875a2ddcce99"><span>Supporting Causes</span><small>cups &middot; mugs &middot; tumblers</small></li>
                          <li data-wrap-option="men" data-video-id="3b6e9b07e55512bf69b1f4bcd59489b1"><span>Men</span><small>cups &middot; mugs &middot; tumblers</small></li>
                          <li data-wrap-option="careers-hobbies" data-video-id="f003a3be6d1efc71dfd7a1051ae931c1"><span>Careers &amp; Hobbies</span><small>cups &middot; mugs &middot; tumblers</small></li>
                          <li data-wrap-option="sports" data-video-id="b256183a06842b86d88c6cbfb1de0225"><span>Sports</span><small>cups &middot; mugs &middot; tumblers</small></li>
                          <li data-wrap-option="religion" data-video-id="9bcf826bc7560dfa80644d3f4bc37f00"><span>Religion</span><small>cups &middot; mugs &middot; tumblers</small></li>
                        </ul>
                      </details>
                    </div>
                    <div class="design-notes-panel">
                      <div class="design-notes-grid">
                        <div>
                          <p class="design-palette-title design-palette-title--center design-palette-title--highlight">Color</p>
                          <div class="design-selection-target" data-selected-color>
                            <div class="design-selection-swatch" aria-hidden="true"></div>
                            <span class="design-selection-label">Select a color</span>
                            <button type="button" class="design-selection-clear" data-clear-color aria-label="Clear color selection">&times;</button>
                          </div>
                        </div>
                        <div>
                          <p class="design-palette-title design-palette-title--center design-palette-title--highlight">Accessory</p>
                          <div class="design-selection-target" data-selected-accessory>
                            <div class="design-selection-swatch" aria-hidden="true"></div>
                            <span class="design-selection-label">Select an accessory</span>
                            <button type="button" class="design-selection-clear" data-clear-accessory aria-label="Clear accessory selection">&times;</button>
                          </div>
                        </div>
                        <div class="wrap-field">
                          <p class="design-palette-title design-palette-title--center design-palette-title--highlight">Wrap Template</p>
                          <div class="design-selection-target design-selection-target--wrap" data-selected-wrap>
                            <div class="design-selection-swatch" aria-hidden="true"></div>
                            <span class="design-selection-label">Select a wrap template</span>
                            <button type="button" class="design-selection-clear" data-clear-wrap aria-label="Clear wrap selection">&times;</button>
                          </div>
                        </div>
                      </div>
                      <label class="design-notes-label" for="design-notes-customization" style="color:#000;">Customer Notes</label>
                      <div class="design-notes-field">
                        <textarea id="design-notes-customization" name="design-notes" placeholder="Share favorite color combos, accessory ideas, or special instructions..." style="color:#000 !important;"></textarea>
                      </div>
                      <div class="support-upload">
                        <input type="file" id="designUploadCustomization" class="support-upload-input" accept="image/*,.pdf,.ai,.psd" />
                        <label for="designUploadCustomization" class="support-upload-trigger">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="w-5 h-5" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m15.172 7.757-6.364 6.364a2.5 2.5 0 1 0 3.536 3.536l6.364-6.364a4.5 4.5 0 0 0-6.364-6.364l-6.364 6.364a6.5 6.5 0 1 0 9.192 9.192l5.657-5.657"/></svg>
                          <span>Upload Inspiration</span>
                        </label>
                        <p class="support-upload-help">Optional: include an image or PDF for your design.</p>
                      </div>
                      <div class="design-price-wrapper">
                        <div class="design-price-bubble" data-design-price>
                          <span class="design-price-value">$0.00</span>
                        </div>
                      </div>
                    </div>
                    <div class="cta-wrap">
                      <a href="checkout.html" class="cta-btn" data-design-submit>
                        Submit Your Design
                      </a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>      </main>

      <footer>
        Lovett's Designs &amp; Crafts · Design creations made with love
      </footer>
    </div>
    <script src="commerce.js" defer></script>
    <script>
      (() => {
        const DESIGN_SELECTION_KEY = 'ldcDesignSelection';
        const DESIGN_SELECTION_PENDING_KEY = 'ldcDesignSelectionPending';
        const DESIGN_SELECTION_PENDING_AT_KEY = 'ldcDesignSelectionPendingAt';
        const CART_STORAGE_KEY = 'ldc:cart';
        const designFrame = document.querySelector('[data-design-frame]');
        const designImageWrap = designFrame?.querySelector('[data-design-image-wrap]');
        const designImage = designFrame?.querySelector('[data-design-image]');
        const designVideo = designFrame?.querySelector('[data-design-video]');
        const designBackButton = designFrame?.querySelector('[data-design-back]');
        const designVideoPrompt = designFrame?.querySelector('[data-design-video-prompt]');
        const designVideoPromptTitle = designFrame?.querySelector('[data-prompt-title]');
        const designVideoPromptBody = designFrame?.querySelector('[data-prompt-body]');
        const designVideoPromptCta = designFrame?.querySelector('[data-prompt-cta]');
        const designPriceValue = document.querySelector('[data-design-price] .design-price-value');
        const designAttachmentInput = document.getElementById('designUploadCustomization');
        let designScrollPending = false;
        const scrollDesignPreviewIntoView = (targetEl = designFrame) => {
          const target = targetEl || designFrame;
          if (!target || designScrollPending) return;
          designScrollPending = true;
          requestAnimationFrame(() => {
            designScrollPending = false;
            const rect = target.getBoundingClientRect();
            const targetTop = rect.top + window.pageYOffset - (window.innerHeight - rect.height) / 2;
            const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
            window.scrollTo({
              top: Math.max(0, targetTop),
              behavior: prefersReduced ? 'auto' : 'smooth'
            });
          });
        };
        const bindUploadLabels = () => {
          document.querySelectorAll('.support-upload-input').forEach(input => {
            if (input.dataset.uploadInit) return;
            input.dataset.uploadInit = 'true';
            const labelSpan = input.closest('.support-upload')?.querySelector('.support-upload-trigger span');
            if (!labelSpan) return;
            const defaultText = labelSpan.textContent.trim();
            labelSpan.dataset.defaultText = defaultText;
            input.addEventListener('change', () => {
              const file = input.files?.[0];
              labelSpan.textContent = file ? file.name : labelSpan.dataset.defaultText || defaultText;
            });
          });
        };
        const setDesignPreviewImage = (src, alt) => {
          if (!designImage || !designImageWrap) return;
          if (src) {
            designImage.setAttribute('src', src);
            designImage.setAttribute('alt', alt || 'Custom design preview');
            designImageWrap.classList.add('has-image');
            designFrame?.classList.add('has-image');
          } else {
            designImage.removeAttribute('src');
            designImage.setAttribute('alt', 'Design preview');
            designImageWrap.classList.remove('has-image');
            designFrame?.classList.remove('has-image');
          }
        };
        const readDesignAttachment = () => {
          return new Promise(resolve => {
            const file = designAttachmentInput?.files?.[0];
            if (!file) return resolve(null);
            const maxBytes = 5 * 1024 * 1024;
            const info = { name: file.name, type: file.type, size: file.size };
            if (file.size > maxBytes) return resolve({ ...info, dataUrl: '' });
            const reader = new FileReader();
            reader.onload = () => resolve({ ...info, dataUrl: typeof reader.result === 'string' ? reader.result : '' });
            reader.onerror = () => resolve({ ...info, dataUrl: '' });
            reader.readAsDataURL(file);
          });
        };
        const medusaBackend = document.body?.dataset?.medusaBackend || '';
        const medusaPublishableKey = document.body?.dataset?.medusaPublishableKey || '';
        const uploadDesignAttachment = async (attachment) => {
          if (!attachment?.dataUrl || !medusaBackend) return null;
          const response = await fetch(`${medusaBackend.replace(/\/$/, '')}/store/design-attachments`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              ...(medusaPublishableKey ? { 'x-publishable-api-key': medusaPublishableKey } : {})
            },
            mode: 'cors',
            credentials: 'omit',
            body: JSON.stringify({
              filename: attachment.name,
              content_type: attachment.type,
              data_url: attachment.dataUrl
            })
          });
          if (!response.ok) {
            const text = await response.text().catch(() => '');
            throw new Error(text || `Attachment upload failed (${response.status})`);
          }
          return response.json();
        };
        const designColorPreview = document.querySelector('[data-color-preview]');
        const designColorPreviewWrap = designColorPreview?.closest('.design-preview-tile');
        const designColorPreviewGlyph = designColorPreview?.querySelector('.design-preview-glyph');
        const designAccessoryPreview = document.querySelector('[data-accessory-preview]');
        const designAccessoryPreviewWrap = designAccessoryPreview?.closest('.design-preview-tile');
        const designAccessoryPreviewGlyph = designAccessoryPreview?.querySelector('.design-preview-glyph');
        const designColorPreviewClear = designColorPreviewWrap?.querySelector('[data-clear-preview-color]');
        const designAccessoryPreviewClear = designAccessoryPreviewWrap?.querySelector('[data-clear-preview-accessory]');
        const designImagePreviewClear = designFrame?.querySelector('[data-clear-preview-image]');
        let accessoryPrice = 0;
        let wrapPrice = 0;
        let selectedAccessoryLabel = '';
        let selectedAccessoryStyle = '';
        let selectedAccessoryGlyph = '';
        let selectedAccessoryImageSrc = '';
        let selectedAccessoryImageAlt = '';
        let selectedColorLabel = '';
        let selectedColorStyle = '';
        let selectedColorGlyph = '';
        let selectedWrapLabel = '';
        let selectedDesignName = '';
        let selectedDesignVariantId = '';
        let selectedDesignProductKey = '';
        let selectedDesignProductHandle = '';
        let selectedDesignProductId = '';
        let lastPrice = { amount: 0 };
        let lastImageState = designImage && designImage.getAttribute('src')
          ? {
              src: designImage.getAttribute('src'),
              alt: designImage.getAttribute('alt') || 'Custom design preview'
            }
          : null;
        setDesignPreviewImage(lastImageState?.src, lastImageState?.alt);

        const formatPrice = value => {
          const num = typeof value === 'number' && !Number.isNaN(value) ? value : 0;
          return `$${num.toFixed(2)}`;
        };

        const setDesignPrice = value => {
          if (!designPriceValue) return;
          designPriceValue.textContent = formatPrice(value);
        };

        const updateDesignTotal = () => {
          const base = typeof lastPrice?.amount === 'number' ? lastPrice.amount : 0;
          setDesignPrice(base + accessoryPrice + wrapPrice);
        };

        function updateColorPreview(style, label, glyph = '') {
          if (!designColorPreview) return;
          if (style) {
            designColorPreview.setAttribute('style', `${style};`);
            designColorPreview.setAttribute('aria-label', label ? `Selected color ${label}` : 'Selected color');
            designColorPreviewWrap?.classList.add('has-selection');
            if (designColorPreviewGlyph) {
              designColorPreviewGlyph.textContent = glyph || '';
            }
          } else {
            designColorPreview.removeAttribute('style');
            designColorPreview.setAttribute('aria-label', 'No color selected');
            designColorPreviewWrap?.classList.remove('has-selection');
            if (designColorPreviewGlyph) {
              designColorPreviewGlyph.textContent = '';
            }
          }
        }

        updateColorPreview('', '');

        const buildAccessoryPreviewStyle = (baseStyle, imageSrc) => {
          const parts = [];
          if (baseStyle) parts.push(baseStyle.trim().replace(/;$/, ''));
          if (imageSrc) {
            parts.push(
              `background-image: url("${imageSrc}"); background-size: contain; background-position: center; background-repeat: no-repeat;`
            );
          }
          return parts.filter(Boolean).join('; ');
        };

        function updateAccessoryPreview(style, label, glyph = '', imageSrc = '', imageAlt = '') {
          if (!designAccessoryPreview) return;
          const resolvedImageSrc = typeof imageSrc === 'string' ? imageSrc : '';
          const resolvedImageAlt = typeof imageAlt === 'string' ? imageAlt : '';
          if (style || resolvedImageSrc) {
            const previewStyle = buildAccessoryPreviewStyle(style, resolvedImageSrc);
            if (previewStyle) {
              designAccessoryPreview.setAttribute('style', `${previewStyle};`);
            } else {
              designAccessoryPreview.removeAttribute('style');
            }
            const labelText = label || resolvedImageAlt;
            designAccessoryPreview.setAttribute('aria-label', labelText ? `Selected accessory ${labelText}` : 'Selected accessory');
            designAccessoryPreviewWrap?.classList.add('has-selection');
            if (designAccessoryPreviewGlyph) {
              designAccessoryPreviewGlyph.textContent = resolvedImageSrc ? '' : (glyph || '');
            }
          } else {
            designAccessoryPreview.removeAttribute('style');
            designAccessoryPreview.setAttribute('aria-label', 'No accessory selected');
            designAccessoryPreviewWrap?.classList.remove('has-selection');
            if (designAccessoryPreviewGlyph) {
              designAccessoryPreviewGlyph.textContent = '';
            }
          }
        }

        updateAccessoryPreview('', '');

        const designColorTrack = document.querySelector('[data-design-colors-source]');
        const normalizeSwatchLabel = raw => {
          if (!raw) return '';
          return raw
            .replace(/\s*swatch\b/i, '')
            .replace(/^view\s+/i, '')
            .replace(/\s+option\b/i, '')
            .replace(/\baccessory\b/gi, '')
            .replace(/\baccent\b/gi, '')
            .trim();
        };
        const sanitizeSwatchStyle = style => {
          if (!style) return '';
          return style
            .replace(/(^|;)\s*(width|height|min-width|max-width|min-height|max-height|flex)\s*:\s*[^;]+;?/gi, ';')
            .replace(/(^|;)\s*padding(?:-(?:left|right|top|bottom))?\s*:\s*[^;]+;?/gi, ';')
            .replace(/(^|;)\s*border-radius\s*:\s*[^;]+;?/gi, ';')
            .replace(/;{2,}/g, ';')
            .replace(/^\s*;\s*|\s*;\s*$/g, '')
            .trim();
        };
        const readSwatchData = swatch => {
          if (!swatch) return null;
          const rawLabel = swatch.getAttribute('aria-label') || swatch.getAttribute('title') || '';
          return {
            style: sanitizeSwatchStyle(swatch.getAttribute('style') || ''),
            label: normalizeSwatchLabel(rawLabel),
            glyph: (swatch.textContent || '').trim(),
            imageSrc: swatch.getAttribute('data-image-src') || '',
            imageAlt: swatch.getAttribute('data-image-alt') || ''
          };
        };
        const defaultDesignSwatches = designColorTrack
          ? Array.from(designColorTrack.querySelectorAll('.swatch'))
              .map(readSwatchData)
              .filter(Boolean)
          : [];
        const buildDesignSwatch = data => {
          const swatch = document.createElement('span');
          swatch.className = 'swatch';
          if (data?.style) swatch.setAttribute('style', sanitizeSwatchStyle(data.style));
          if (data?.label) swatch.setAttribute('aria-label', data.label);
          if (data?.glyph) swatch.textContent = data.glyph;
          if (data?.imageSrc) swatch.setAttribute('data-image-src', data.imageSrc);
          if (data?.imageAlt) swatch.setAttribute('data-image-alt', data.imageAlt);
          return swatch;
        };
        const resetDesignColorSelection = () => {
          document.querySelectorAll('[data-selected-color]').forEach(colorTarget => {
            const swatchNode = colorTarget.querySelector('.design-selection-swatch');
            const labelNode = colorTarget.querySelector('.design-selection-label');
            if (swatchNode) {
              swatchNode.removeAttribute('style');
              swatchNode.textContent = '';
            }
            if (labelNode) {
              labelNode.textContent = 'Select a color';
            }
            colorTarget.classList.remove('has-selection');
          });
          selectedColorLabel = '';
          selectedColorStyle = '';
          selectedColorGlyph = '';
          updateColorPreview('', '');
          document
            .querySelectorAll('[data-design-colors-source] .swatch.is-active')
            .forEach(el => el.classList.remove('is-active'));
        };
        const resetDesignAccessorySelection = () => {
          document.querySelectorAll('[data-selected-accessory]').forEach(accessoryTarget => {
            const swatchNode = accessoryTarget.querySelector('.design-selection-swatch');
            const labelNode = accessoryTarget.querySelector('.design-selection-label');
            if (swatchNode) {
              swatchNode.removeAttribute('style');
              swatchNode.textContent = '';
            }
            if (labelNode) {
              labelNode.textContent = 'Select an accessory';
            }
            accessoryTarget.classList.remove('has-selection');
          });
          selectedAccessoryLabel = '';
          selectedAccessoryStyle = '';
          selectedAccessoryGlyph = '';
          selectedAccessoryImageSrc = '';
          selectedAccessoryImageAlt = '';
          accessoryPrice = 0;
          updateAccessoryPreview('', '');
          document
            .querySelectorAll('[data-design-accessories-source] .swatch.is-active')
            .forEach(el => el.classList.remove('is-active'));
        };
        const resetDesignWrapSelection = () => {
          document.querySelectorAll('[data-selected-wrap]').forEach(wrapTarget => {
            const swatchNode = wrapTarget.querySelector('.design-selection-swatch');
            const labelNode = wrapTarget.querySelector('.design-selection-label');
            if (swatchNode) {
              swatchNode.removeAttribute('style');
              swatchNode.textContent = '';
            }
            if (labelNode) {
              labelNode.textContent = 'Select a wrap template';
            }
            wrapTarget.classList.remove('has-selection');
          });
          selectedWrapLabel = '';
          wrapPrice = 0;
        };
        const resetDesignSelections = () => {
          resetDesignColorSelection();
          resetDesignAccessorySelection();
          resetDesignWrapSelection();
          updateDesignTotal();
        };
        const clearDesignImageSelection = () => {
          lastImageState = null;
          selectedDesignName = '';
          lastPrice = { amount: 0 };
          try {
            localStorage.removeItem(DESIGN_SELECTION_KEY);
            localStorage.removeItem(DESIGN_SELECTION_PENDING_KEY);
            localStorage.removeItem(DESIGN_SELECTION_PENDING_AT_KEY);
          } catch {}
          showImagePreview();
          updateDesignTotal();
        };
        const resetDesignSwatchSlider = () => {
          if (!designColorTrack) return;
          const slider = designColorTrack.closest('[data-swatch-slider]');
          if (slider) slider.dataset.sliderIndex = '0';
          designColorTrack.style.transform = 'translateX(0px)';
          window.dispatchEvent(new Event('resize'));
        };
        const setDesignColorSwatches = swatches => {
          if (!designColorTrack) return;
          const next = Array.isArray(swatches) && swatches.length ? swatches : defaultDesignSwatches;
          designColorTrack.innerHTML = '';
          next.forEach(item => designColorTrack.appendChild(buildDesignSwatch(item)));
          designColorTrack.querySelectorAll('.swatch.is-active').forEach(el => el.classList.remove('is-active'));
          resetDesignColorSelection();
          resetDesignSwatchSlider();
        };

        designColorPreviewClear?.addEventListener('click', event => {
          event.preventDefault();
          resetDesignColorSelection();
        });

        designAccessoryPreviewClear?.addEventListener('click', event => {
          event.preventDefault();
          resetDesignAccessorySelection();
          updateDesignTotal();
        });

        designImagePreviewClear?.addEventListener('click', event => {
          event.preventDefault();
          clearDesignImageSelection();
        });

        const initBasePrice = () => {
          if (!designPriceValue) return;
          const raw = designPriceValue.textContent || '';
          const numeric = parseFloat(raw.replace(/[^0-9.]/g, ''));
          lastPrice = { amount: Number.isFinite(numeric) ? numeric : 0 };
          updateDesignTotal();
        };

        const rememberCurrentImage = () => {
          if (!designImage) return;
          const src = designImage.getAttribute('src');
          if (!src) return;
          lastImageState = {
            src,
            alt: designImage.getAttribute('alt') || 'Custom design preview'
          };
        };

        const showImagePreview = () => {
          if (!designFrame || !designImage) return;
          designFrame.classList.remove('is-video-active', 'is-prompt-active');
          designVideoPrompt?.setAttribute('hidden', 'true');
          designVideoPrompt?.setAttribute('aria-hidden', 'true');
          if (designVideo) {
            designVideo.pause?.();
            const sourceEl = designVideo.querySelector('source');
            if (sourceEl) {
              sourceEl.removeAttribute('src');
            }
            designVideo.load?.();
          }
          if (lastImageState?.src) {
            setDesignPreviewImage(lastImageState.src, lastImageState.alt);
          } else {
            setDesignPreviewImage('', '');
          }
          if (designBackButton) {
            designBackButton.hidden = true;
          }
        };

        const showVideoById = videoId => {
          if (!videoId || !designFrame || !designVideo) return;
          designFrame.classList.remove('is-prompt-active');
          rememberCurrentImage();
          const sourceUrl = `https://customer-3ptq6xbmg2sfpv29.cloudflarestream.com/${videoId}/manifest/video.m3u8`;
          const sourceEl = designVideo.querySelector('source');
          if (sourceEl) {
            sourceEl.setAttribute('src', sourceUrl);
          }
          designVideoPrompt?.setAttribute('hidden', 'true');
          designVideoPrompt?.setAttribute('aria-hidden', 'true');
          designFrame.classList.add('is-video-active');
          if (designBackButton) {
            designBackButton.hidden = false;
          }
          designVideo.load?.();
          designVideo.play?.();
        };

        const showVideoPrompt = (title, body, ctaLabel, ctaHref) => {
          if (!designFrame || !designVideoPrompt) return;
          designFrame.classList.add('is-prompt-active');
          rememberCurrentImage();
          if (designVideo) {
            designVideo.pause?.();
            const sourceEl = designVideo.querySelector('source');
            if (sourceEl) {
              sourceEl.removeAttribute('src');
            }
            designVideo.load?.();
          }
          if (designVideoPromptTitle) {
            designVideoPromptTitle.textContent = title || 'Need a Special Character or Designer Wrap?';
          }
          if (designVideoPromptBody) {
            designVideoPromptBody.textContent = body || 'Share your character or designer theme with us and we will send next steps.';
          }
          if (designVideoPromptCta) {
            designVideoPromptCta.textContent = ctaLabel || 'Request Custom Wrap';
            designVideoPromptCta.setAttribute('href', ctaHref || 'mailto:lovettsdandc@gmail.com');
          }
          designVideoPrompt.removeAttribute('hidden');
          designVideoPrompt.setAttribute('aria-hidden', 'false');
          designFrame.classList.add('is-video-active');
          if (designBackButton) {
            designBackButton.hidden = false;
          }
        };

        designBackButton?.addEventListener('click', showImagePreview);

        try {
          const storedValue = localStorage.getItem(DESIGN_SELECTION_KEY);
          if (storedValue && designImage) {
            const parsed = JSON.parse(storedValue);
            if (parsed && typeof parsed === 'object' && parsed.src) {
              const storedSwatches = Array.isArray(parsed.swatches)
                ? parsed.swatches.filter(item => item && (item.style || item.glyph || item.imageSrc))
                : [];
              if (storedSwatches.length) {
                setDesignColorSwatches(storedSwatches);
              }
              resetDesignSelections();
              setDesignPreviewImage(parsed.src, parsed.alt);
              lastImageState = {
                src: parsed.src,
                alt: parsed.alt || 'Custom design preview'
              };
              if (typeof parsed.price === 'number') {
                lastPrice = { amount: parsed.price };
                updateDesignTotal();
              }
              if (parsed.name) {
                selectedDesignName = parsed.name;
              }
              if (parsed.variantId) {
                selectedDesignVariantId = parsed.variantId;
              }
              if (parsed.productKey) selectedDesignProductKey = parsed.productKey;
              if (parsed.productHandle) selectedDesignProductHandle = parsed.productHandle;
              if (parsed.productId) selectedDesignProductId = parsed.productId;
            }
          }
          localStorage.removeItem(DESIGN_SELECTION_PENDING_KEY);
          localStorage.removeItem(DESIGN_SELECTION_PENDING_AT_KEY);
        } catch (error) {
          console.warn('Unable to load saved design selection', error);
        }

        const initSwatchSliders = () => {
          document.querySelectorAll('[data-swatch-slider]').forEach(slider => {
            if (slider.dataset.sliderInit) return;
            slider.dataset.sliderInit = 'true';
            const track = slider.querySelector('[data-swatch-track]');
            const windowEl = slider.querySelector('[data-swatch-window]');
            const prev = slider.querySelector('[data-swatch-prev]');
            const next = slider.querySelector('[data-swatch-next]');
            const baseVisible = Number(slider.getAttribute('data-visible') || 5);
            const mobileVisible = Number(slider.getAttribute('data-visible-mobile') || baseVisible);
            const isMobile = () => window.matchMedia('(max-width: 767px)').matches;
            const getRequested = () => (isMobile() ? mobileVisible : baseVisible);
            const getVisible = () => {
              const requested = getRequested();
              const total = track ? track.children.length : 0;
              return total ? Math.min(requested, total) : requested;
            };
            let index = Number.parseInt(slider.dataset.sliderIndex || '0', 10);
            if (!Number.isFinite(index)) index = 0;

            const setWindowWidth = () => {
              if (!windowEl || !track) return;
              const first = track.children[0];
              if (!first) return;
              const styles = getComputedStyle(track);
              const gap = parseFloat(styles.gap || styles.columnGap || '0');
              const swatchWidth = first.offsetWidth || first.getBoundingClientRect().width;
              const requested = getRequested();
              const visible = getVisible();
              const total = track.children.length;
              const isDesignSlider = slider.classList.contains('design-swatch-slider');
              const shouldCenter = isDesignSlider && total <= visible;
              const widthCount = Math.max(1, shouldCenter ? requested : visible);
              const totalWidth = swatchWidth * widthCount + gap * (widthCount - 1);
              const windowStyles = getComputedStyle(windowEl);
              const paddingX =
                parseFloat(windowStyles.paddingLeft || '0') +
                parseFloat(windowStyles.paddingRight || '0');
              const inset = isDesignSlider && isMobile() ? 1 : 0;
              windowEl.style.width = `${totalWidth + paddingX - inset}px`;
              windowEl.style.maxWidth = '';
            };

            const update = () => {
              if (!track) return;
              const storedIndex = Number.parseInt(slider.dataset.sliderIndex || '', 10);
              if (!Number.isNaN(storedIndex)) {
                index = storedIndex;
              }
              const swatches = Array.from(track.children);
              const total = swatches.length;
              const visible = getVisible();
              const maxIndex = Math.max(0, total - visible);
              const isDesignSlider = slider.classList.contains('design-swatch-slider');
              if (isDesignSlider) {
                if (maxIndex === 0) {
                  slider.dataset.swatchAlign = 'center';
                } else {
                  delete slider.dataset.swatchAlign;
                }
              }
              if (maxIndex === 0) {
                index = 0;
              } else if (index < 0) {
                index = maxIndex;
              } else if (index > maxIndex) {
                index = 0;
              }
              slider.dataset.sliderIndex = String(index);
              const first = swatches[0];
              const styles = getComputedStyle(track);
              const gap = parseFloat(styles.gap || styles.columnGap || '0');
              const swatchWidth = first ? (first.offsetWidth || first.getBoundingClientRect().width) : 0;
              const offset = (swatchWidth + gap) * index;
              track.style.transform = `translateX(-${offset}px)`;
              const disable = maxIndex === 0;
              if (prev) {
                prev.classList.toggle('opacity-40', disable);
                prev.classList.toggle('pointer-events-none', disable);
                prev.setAttribute('aria-disabled', disable ? 'true' : 'false');
              }
              if (next) {
                next.classList.toggle('opacity-40', disable);
                next.classList.toggle('pointer-events-none', disable);
                next.setAttribute('aria-disabled', disable ? 'true' : 'false');
              }
            };

            const step = direction => {
              index += direction;
              slider.dataset.sliderIndex = String(index);
              update();
            };

            prev?.addEventListener('click', event => {
              event.preventDefault();
              step(-1);
            });
            next?.addEventListener('click', event => {
              event.preventDefault();
              step(1);
            });

            window.addEventListener('resize', setWindowWidth);
            window.addEventListener('resize', update);
            setWindowWidth();
            update();
          });
        };

        const activateSwatchVisual = swatch => {
          if (!swatch) return;
          const track = swatch.closest('[data-swatch-track]');
          if (track) {
            track.querySelectorAll('.swatch.is-active').forEach(el => {
              if (el !== swatch) el.classList.remove('is-active');
            });
          }
          swatch.classList.add('is-active');
        };

        const clearActiveSwatches = selector => {
          document.querySelectorAll(selector).forEach(el => el.classList.remove('is-active'));
        };

        const initDesignSelections = () => {
          const colorTarget = document.querySelector('[data-selected-color]');
          const accessoryTarget = document.querySelector('[data-selected-accessory]');
          const wrapTarget = document.querySelector('[data-selected-wrap]');
          if (!colorTarget && !accessoryTarget && !wrapTarget) return;

        const cleanLabel = raw => {
          if (!raw) return raw;
          const stripped = raw
            .replace(/\s*swatch\b/i, '')
            .replace(/^view\s+/i, '')
            .replace(/\s+option\b/i, '')
            .replace(/\baccessory\b/gi, '')
            .replace(/\baccent\b/gi, '')
            .trim();
          if (!stripped) return stripped;
          return stripped.replace(/\b\w+/g, word => word.charAt(0).toUpperCase() + word.slice(1));
        };

        const applyToTarget = (target, swatch, placeholder) => {
          if (!target || !swatch) return;
          const style = swatch.getAttribute('style') || '';
          const text = (swatch.textContent || '').trim();
          const label = cleanLabel(swatch.getAttribute('aria-label') || placeholder);
          const swatchNode = target.querySelector('.design-selection-swatch');
          const labelNode = target.querySelector('.design-selection-label');
          if (swatchNode) {
            swatchNode.setAttribute('style', style);
            swatchNode.textContent = text;
          }
          activateSwatchVisual(swatch);
          if (labelNode) {
              labelNode.textContent = label;
            }
          target.classList.add('has-selection');
          if (target === accessoryTarget) {
            const priceAttr = swatch.getAttribute('data-price');
            const parsedPrice = priceAttr ? parseFloat(priceAttr) : 0;
            accessoryPrice = Number.isFinite(parsedPrice) ? parsedPrice : 0;
            selectedAccessoryLabel = label;
            selectedAccessoryStyle = style;
            selectedAccessoryGlyph = text;
            selectedAccessoryImageSrc = swatch.getAttribute('data-image-src') || '';
            selectedAccessoryImageAlt = swatch.getAttribute('data-image-alt') || '';
            updateAccessoryPreview(style, label, text, selectedAccessoryImageSrc, selectedAccessoryImageAlt);
            updateDesignTotal();
          } else if (target === colorTarget) {
            selectedColorLabel = label;
            selectedColorStyle = style;
            selectedColorGlyph = text;
            updateColorPreview(style, label, text);
            const imageSrc = swatch.getAttribute('data-image-src');
            if (imageSrc) {
              lastImageState = {
                src: imageSrc,
                alt: swatch.getAttribute('data-image-alt') || label || 'Custom design preview'
              };
              showImagePreview();
            }
          }
          const previewTarget =
            target === colorTarget
              ? designColorPreviewWrap
              : target === accessoryTarget
                ? designAccessoryPreviewWrap
                : designFrame;
          scrollDesignPreviewIntoView(previewTarget);
        };

          const clearTarget = (target, placeholder) => {
            if (!target) return;
            const swatchNode = target.querySelector('.design-selection-swatch');
            const labelNode = target.querySelector('.design-selection-label');
            if (swatchNode) {
              swatchNode.removeAttribute('style');
              swatchNode.textContent = '';
            }
          if (labelNode) {
            labelNode.textContent = placeholder;
          }
          target.classList.remove('has-selection');
          if (target === accessoryTarget) {
            clearActiveSwatches('[data-design-accessories-source] .swatch.is-active');
            accessoryPrice = 0;
            selectedAccessoryStyle = '';
            selectedAccessoryGlyph = '';
            selectedAccessoryImageSrc = '';
            selectedAccessoryImageAlt = '';
            updateAccessoryPreview('', '');
            updateDesignTotal();
          } else if (target === colorTarget) {
            clearActiveSwatches('[data-design-colors-source] .swatch.is-active');
            selectedColorLabel = '';
            selectedColorStyle = '';
            selectedColorGlyph = '';
            updateColorPreview('', '');
          }
        };

          const bindSwatches = (selector, target, placeholder) => {
            if (!target) return;
            document.querySelectorAll(selector).forEach(swatch => {
              if (swatch.dataset.selectionInit) return;
              swatch.dataset.selectionInit = 'true';
              swatch.setAttribute('role', 'button');
              swatch.setAttribute('tabindex', '0');
              const activate = event => {
                if (event) event.preventDefault();
                activateSwatchVisual(swatch);
                applyToTarget(target, swatch, placeholder);
              };
              swatch.addEventListener('click', activate);
              swatch.addEventListener('keydown', event => {
                if (event.key === 'Enter' || event.key === ' ') {
                  event.preventDefault();
                  activate(event);
                }
              });
            });
          };

        const applyWrapSelection = label => {
          if (!wrapTarget) return;
          const swatchNode = wrapTarget.querySelector('.design-selection-swatch');
          const labelNode = wrapTarget.querySelector('.design-selection-label');
          if (swatchNode) {
            swatchNode.removeAttribute('style');
            swatchNode.textContent = label ? label.charAt(0).toUpperCase() : '';
          }
          if (labelNode) {
            labelNode.textContent = label || 'Select a wrap template';
          }
          if (label) {
            wrapTarget.classList.add('has-selection');
            wrapPrice = 2.5;
            selectedWrapLabel = label;
          } else {
            wrapTarget.classList.remove('has-selection');
            wrapPrice = 0;
            selectedWrapLabel = '';
          }
          updateDesignTotal();
          scrollDesignPreviewIntoView();
        };

          const bindWrapOptions = () => {
            if (!wrapTarget) return;
            document.querySelectorAll('[data-wrap-option]').forEach(option => {
              if (option.dataset.wrapSelectionInit) return;
              option.dataset.wrapSelectionInit = 'true';
              const getLabel = () => {
                const span = option.querySelector('span');
                return span ? span.textContent.trim() : option.textContent.trim();
            };
            const activate = event => {
              if (event) event.preventDefault();
              applyWrapSelection(getLabel());
              const videoId = option.getAttribute('data-video-id');
              const promptTitle = option.getAttribute('data-video-prompt-title');
              const promptBody = option.getAttribute('data-video-prompt');
              const promptCtaLabel = option.getAttribute('data-video-prompt-cta-label');
              const promptCtaHref = option.getAttribute('data-video-prompt-cta-href');
              if (videoId) {
                showVideoById(videoId);
              } else if (promptTitle || promptBody || promptCtaHref) {
                showVideoPrompt(promptTitle, promptBody, promptCtaLabel, promptCtaHref);
              } else {
                showImagePreview();
              }
            };
            option.addEventListener('click', activate);
            option.addEventListener('keydown', event => {
              if (event.key === 'Enter' || event.key === ' ') {
                event.preventDefault();
                  activate(event);
                }
              });
            });
          };

          bindSwatches('[data-design-colors-source] .swatch', colorTarget, 'Color selected');
          bindSwatches('[data-design-accessories-source] .swatch', accessoryTarget, 'Accessory selected');
          bindWrapOptions();

          const ensureDefaultSelection = (selector, target, placeholder) => {
            if (!target) return;
            const hasSelection = target.classList.contains('has-selection');
            const active = document.querySelector(`${selector}.is-active`);
            const first = document.querySelector(selector);
            if (!hasSelection && !active && first) {
              activateSwatchVisual(first);
            }
          };

          ensureDefaultSelection('[data-design-colors-source] .swatch', colorTarget, 'Color selected');
          ensureDefaultSelection('[data-design-accessories-source] .swatch', accessoryTarget, 'Accessory selected');
        const bindClear = (buttonSelector, target, placeholder, onClear) => {
          const button = document.querySelector(buttonSelector);
          if (!button || button.dataset.designClearInit) return;
          button.dataset.designClearInit = 'true';
          button.addEventListener('click', () => {
            clearTarget(target, placeholder);
            if (typeof onClear === 'function') {
              onClear();
            }
          });
        };

        bindClear('[data-clear-color]', colorTarget, 'Select a color');
        bindClear('[data-clear-accessory]', accessoryTarget, 'Select an accessory');
        bindClear('[data-clear-wrap]', wrapTarget, 'Select a wrap template', () => {
          wrapPrice = 0;
          selectedWrapLabel = '';
          updateDesignTotal();
          showImagePreview();
        });
      };

        const buildImagePreviewStyle = src => {
          if (!src) return '';
          return `background-color: #ffffff; background-image: url("${src}"); background-size: cover; background-position: center; background-repeat: no-repeat;`;
        };

        const buildDesignProduct = async (idOverride, uploadedAttachment = null) => {
          const basePrice = typeof lastPrice?.amount === 'number' ? lastPrice.amount : 0;
          const totalPrice = basePrice + accessoryPrice + wrapPrice;
          const nameParts = [];
          if (selectedDesignName) nameParts.push(selectedDesignName);
          if (selectedColorLabel) nameParts.push(`Color: ${selectedColorLabel}`);
          if (selectedAccessoryLabel) nameParts.push(`Accessory: ${selectedAccessoryLabel}`);
          if (selectedWrapLabel) nameParts.push(`Wrap: ${selectedWrapLabel}`);
          const cartName = nameParts.length ? `Custom Design – ${nameParts.join(' · ')}` : 'Custom Design';
          const previewSrc = lastImageState?.src || designImage?.getAttribute('src') || '';
          const previewStyle = buildImagePreviewStyle(previewSrc);
          const notesEl = document.getElementById('design-notes-customization');
          const attachment = await readDesignAttachment();
          const attachmentUrl = uploadedAttachment?.url || '';
          return {
            id: idOverride || `design-${Date.now()}`,
            name: cartName,
            price: totalPrice,
            quantity: 1,
            previewStyle,
            options: [
              selectedColorLabel
                ? { label: 'Color', value: selectedColorLabel, swatchStyle: selectedColorStyle, swatchGlyph: selectedColorGlyph }
                : null,
              selectedAccessoryLabel
                ? {
                    label: 'Accessory',
                    value: selectedAccessoryLabel,
                    swatchStyle: selectedAccessoryStyle,
                    swatchGlyph: selectedAccessoryGlyph
                  }
                : null,
              selectedWrapLabel ? { label: 'Wrap', value: selectedWrapLabel } : null,
              attachment?.name
                ? {
                    label: 'Attachment',
                    value: attachment.name,
                    attachmentData: attachmentUrl || attachment.dataUrl || ''
                  }
                : null
            ].filter(Boolean),
            notes: notesEl ? notesEl.value.trim() : ''
          };
        };

        const buildDesignMetadata = async (variantIdOverride, uploadedAttachment = null, attachment = null) => {
          const previewSrc = lastImageState?.src || designImage?.getAttribute('src') || '';
          const previewAlt = lastImageState?.alt || designImage?.getAttribute('alt') || 'Custom design preview';
          const notesEl = document.getElementById('design-notes-customization');
          const resolvedAttachment = attachment || (await readDesignAttachment());
          const basePrice = typeof lastPrice?.amount === 'number' ? lastPrice.amount : 0;
          const addonPrice = accessoryPrice + wrapPrice;
          const totalPrice = basePrice + addonPrice;
          const metadata = {
            design_mode: 'custom',
            design_preview_url: previewSrc || undefined,
            preview_url: previewSrc || undefined,
            design_preview_alt: previewAlt || undefined,
            design_product_key: selectedDesignProductKey || undefined,
            design_product_handle: selectedDesignProductHandle || undefined,
            design_product_id: selectedDesignProductId || undefined,
            design_variant_id: variantIdOverride || selectedDesignVariantId || undefined,
            design_base_price: basePrice || undefined,
            design_addon_price: addonPrice || undefined,
            design_total_price: totalPrice || undefined,
            design_color_label: selectedColorLabel || undefined,
            design_color_style: selectedColorStyle || undefined,
            design_color_glyph: selectedColorGlyph || undefined,
            design_accessory_label: selectedAccessoryLabel || undefined,
            design_accessory_style: selectedAccessoryStyle || undefined,
            design_accessory_glyph: selectedAccessoryGlyph || undefined,
            design_wrap_label: selectedWrapLabel || undefined,
            design_notes: notesEl ? notesEl.value.trim() : undefined,
            design_attachment_name: resolvedAttachment?.name || undefined,
            design_attachment_url: uploadedAttachment?.url || undefined,
            design_attachment_key: uploadedAttachment?.key || undefined
          };
          return Object.fromEntries(
            Object.entries(metadata).filter(([, value]) => value !== undefined && value !== '')
          );
        };

        const readCartFromStorage = () => {
          try {
            const raw = localStorage.getItem(CART_STORAGE_KEY);
            if (!raw) return { items: [] };
            const parsed = JSON.parse(raw);
            if (parsed && Array.isArray(parsed.items)) {
              return { items: parsed.items.filter(item => item && item.id) };
            }
          } catch {}
          return { items: [] };
        };

        const submitDesign = async () => {
          const designId = `design-${Date.now()}`;
          const product = await buildDesignProduct(designId);
          const commerce = window.LDCCommerce;
          const medusaEnabled = commerce?.enabled && (document.body?.dataset?.medusaEnabled === 'true' || window.LDC_MEDUSA_ENABLED === true);
          if (medusaEnabled) {
            const resolveVariantFromSelection = async () => {
              if (!commerce?.resolveVariantId) return '';
              const key = selectedDesignProductKey || selectedDesignProductHandle || selectedDesignProductId || '';
              if (!key) return '';
              const dummy = document.createElement('button');
              dummy.dataset.productKey = selectedDesignProductKey || selectedDesignProductHandle || selectedDesignProductId || '';
              if (selectedDesignProductHandle) dummy.dataset.productHandle = selectedDesignProductHandle;
              if (selectedDesignProductId) dummy.dataset.productId = selectedDesignProductId;
              try {
                return (await commerce.resolveVariantId(dummy)) || '';
              } catch {
                return '';
              }
            };
            const resolvedVariantId = selectedDesignVariantId || await resolveVariantFromSelection();
            if (!resolvedVariantId) {
              alert('Select a product to design first (use the pencil icon on a product tile).');
              return;
            }
            selectedDesignVariantId = resolvedVariantId;
            const attachment = await readDesignAttachment();
            let uploadedAttachment = null;
            if (attachment?.dataUrl) {
              uploadedAttachment = await uploadDesignAttachment(attachment);
            } else if (attachment?.name) {
              alert('Attachment is too large. Please upload a file under 5MB.');
            }
            const metadata = await buildDesignMetadata(resolvedVariantId, uploadedAttachment, attachment);
            await commerce.addLineItem(resolvedVariantId, 1, metadata);
            await commerce.syncBadges();
            window.location.href = 'checkout.html';
            return;
          }
          const existingCart = readCartFromStorage();
          const items = Array.isArray(existingCart.items) ? [...existingCart.items] : [];
          items.push(product);
          const checkoutCart = { items };
          try {
            localStorage.setItem(CART_STORAGE_KEY, JSON.stringify(checkoutCart));
          } catch {}
          try {
            sessionStorage.setItem('ldc:design:last', JSON.stringify(product));
          } catch {}
          window.location.href = 'checkout.html';
        };

        const designSubmitBtn = document.querySelector('[data-design-submit]');
        if (designSubmitBtn) {
          designSubmitBtn.addEventListener('click', async event => {
            event.preventDefault();
            try {
              await submitDesign();
            } catch (error) {
              console.warn('Design submit failed to add to cart', error);
              alert('We ran into a problem adding this design to your cart. Please try again.');
            }
          });
        }

        bindUploadLabels();
        initSwatchSliders();
        initDesignSelections();
        initBasePrice();
        updateDesignTotal();
      })();
    </script>
    <script>
      (() => {
        const notes = document.getElementById('design-notes-customization');
        if (!notes) return;
        const autosize = () => {
          notes.style.height = 'auto';
          notes.style.height = `${notes.scrollHeight}px`;
        };
        notes.addEventListener('input', autosize);
        autosize();
      })();

      // Temporary debug panel for design metadata flow.
      (() => {
        const isEnabled = true;
        if (!isEnabled) return;
        if (document.getElementById('ldcDesignDebug')) return;
        const panel = document.createElement('div');
        panel.id = 'ldcDesignDebug';
        panel.style.cssText = [
          'position:fixed',
          'bottom:16px',
          'right:16px',
          'z-index:9999',
          'width:320px',
          'max-height:50vh',
          'overflow:auto',
          'background:rgba(15,23,42,0.95)',
          'color:#fff',
          'padding:12px',
          'border-radius:12px',
          'box-shadow:0 10px 30px rgba(15,23,42,0.35)',
          'font:12px/1.4 ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, \"Liberation Mono\", \"Courier New\", monospace'
        ].join(';');
        panel.innerHTML = `
          <div style="display:flex;align-items:center;justify-content:space-between;gap:8px;">
            <strong>Design Debug</strong>
            <button id="ldcDesignDebugClose" style="background:#ef4444;color:#fff;border:none;border-radius:999px;padding:2px 8px;font-size:10px;cursor:pointer;">Hide</button>
          </div>
          <div id="ldcDesignDebugBody" style="margin-top:8px;"></div>
          <div style="margin-top:8px;display:flex;gap:6px;flex-wrap:wrap;">
            <button id="ldcDesignDebugRefresh" style="background:#22c55e;color:#0f172a;border:none;border-radius:8px;padding:4px 8px;font-size:10px;cursor:pointer;">Refresh</button>
            <button id="ldcDesignDebugCopy" style="background:#38bdf8;color:#0f172a;border:none;border-radius:8px;padding:4px 8px;font-size:10px;cursor:pointer;">Copy</button>
          </div>
        `;
        document.body.appendChild(panel);

        const bodyEl = panel.querySelector('#ldcDesignDebugBody');
        const closeBtn = panel.querySelector('#ldcDesignDebugClose');
        const refreshBtn = panel.querySelector('#ldcDesignDebugRefresh');
        const copyBtn = panel.querySelector('#ldcDesignDebugCopy');

        const render = (data) => {
          if (!bodyEl) return;
          bodyEl.textContent = JSON.stringify(data, null, 2);
        };

        const gather = async () => {
          const commerce = window.LDCCommerce;
          const selection = {
            selectedDesignName,
            selectedColorLabel,
            selectedAccessoryLabel,
            selectedWrapLabel,
            selectedDesignVariantId,
            selectedDesignProductKey,
            selectedDesignProductHandle,
            selectedDesignProductId
          };
          let storedSelection = null;
          try {
            storedSelection = JSON.parse(localStorage.getItem('ldcDesignSelection') || 'null');
          } catch {}
          let cart = null;
          let cartWithMeta = null;
          if (commerce?.getOrCreateCart) {
            try {
              cart = await commerce.getOrCreateCart();
              if (cart?.id) {
                cartWithMeta = await commerce.request(`/store/carts/${cart.id}?fields=+items.metadata`);
              }
            } catch (error) {
              cart = { error: error?.message || String(error) };
            }
          }
          const data = {
            time: new Date().toISOString(),
            storedSelection,
            selection,
            cart: cart?.cart || cart || null,
            cartWithMeta: cartWithMeta?.cart || cartWithMeta || null
          };
          render(data);
          return data;
        };

        closeBtn?.addEventListener('click', () => {
          panel.remove();
        });
        refreshBtn?.addEventListener('click', () => {
          gather();
        });
        copyBtn?.addEventListener('click', async () => {
          const text = bodyEl?.textContent || '';
          try {
            await navigator.clipboard.writeText(text);
          } catch {}
        });

        gather();
        document.addEventListener('cart:set', () => {
          gather();
        });
      })();
    </script>
  </body>
</html>
